#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
删除重复数据并补充新数据
"""
import json

# 读取训练集
with open('D:/Project/毕业设计/data/train/train.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

print(f"删除前：{len(data)} 条")

# 删除重复的"即刻种植即刻修复"
original_count = len(data)
data = [item for item in data if item['input'] != "医生，什么是即刻种植即刻修复？"]
print(f"删除后：{len(data)} 条（删除了 {original_count - len(data)} 条重复）")

# 补充 7 条新数据（因为刚才实际只添加了 39 条新的，需要补 7 条才够 46 条）
new_records = [
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，种植牙手术前需要洗牙吗？",
    "output": "您好，种植牙手术前建议先洗牙：\n\n【为什么要洗牙】\n\n【减少感染风险】\n1. 去除牙结石和牙菌斑\n2. 减少口腔细菌数量\n3. 降低术后感染风险\n4. 有利于伤口愈合\n\n【评估牙周健康】\n1. 检查牙周状况\n2. 发现潜在问题\n3. 及时治疗牙周病\n4. 确保手术安全\n\n【洗牙时间】\n- 术前 1-2 周洗牙\n- 给牙龈恢复时间\n- 不要术前当天洗\n- 避免牙龈出血\n\n【术前口腔准备】\n1. 全口洁治（洗牙）\n2. 治疗龋齿\n3. 控制牙周炎症\n4. 保持口腔卫生\n\n【特殊情况】\n- 口腔卫生好者：可不必\n- 牙周病患者：必须治疗\n- 牙结石多者：强烈建议\n\n建议您术前 1-2 周到院洗牙，为手术创造良好条件。请问您平时有定期洗牙的习惯吗？",
    "category": "术前评估"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，固定义齿戴了后可以用电动牙刷吗？",
    "output": "您好，固定义齿戴了后可以使用电动牙刷：\n\n【使用电动牙刷的好处】\n\n【清洁效果】\n1. 震动频率高，清洁更彻底\n2. 去除牙菌斑效果好\n3. 清洁牙冠边缘\n4. 保护基牙健康\n\n【使用便利】\n1. 省力\n2. 刷牙时间自动控制\n3. 清洁效果好\n4. 推荐使用\n\n【选择建议】\n\n【刷头】\n- 选择软毛刷头\n- 刷头小巧\n- 便于清洁后牙\n- 避免硬毛损伤\n\n【模式】\n- 选择温和模式\n- 避免强力模式\n- 减少刺激\n- 舒适为主\n\n【使用方法】\n1. 刷头 45 度角\n2. 轻柔移动\n3. 每颗牙 2-3 秒\n4. 全程 2 分钟\n\n【注意事项】\n1. 不要用力过猛\n2. 避免损伤牙龈\n3. 定期更换刷头\n4. 配合牙线使用\n\n【不推荐情况】\n- 牙龈严重炎症期\n- 基牙敏感明显\n- 暂时用手动牙刷\n\n电动牙刷是很好的清洁工具，推荐使用。请问您目前用的是手动还是电动牙刷？",
    "category": "术后护理"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，活动义齿可以修复半口牙缺失吗？",
    "output": "您好，活动义齿可以修复半口牙缺失：\n\n【半口活动义齿类型】\n\n【上颌半口义齿】\n- 基托覆盖整个上腭\n- 吸附力好\n- 固位稳定\n- 咀嚼效率约 30-40%\n\n【下颌半口义齿】\n- 基托呈马蹄形\n- 避开舌系带\n- 固位相对较差\n- 需要适应\n\n【适用人群】\n1. 半口多颗牙缺失\n2. 无法耐受种植手术\n3. 经济条件有限\n4. 骨质条件差\n\n【优点】\n1. 价格经济\n2. 适应范围广\n3. 制作简单\n4. 可自行摘戴\n5. 便于清洁\n\n【缺点】\n1. 咀嚼效率较低\n2. 有异物感\n3. 需要适应期\n4. 固位不如种植\n\n【修复方案】\n\n【传统活动义齿】\n- 价格：3000-8000 元\n- 卡环固位\n- 经济实用\n\n【精密附着体义齿】\n- 价格：10000-30000 元\n- 无卡环美观\n- 固位更好\n\n【种植覆盖义齿】\n- 价格：20000-50000 元\n- 种植体固位\n- 稳定性最佳\n\n建议您到院检查，根据口腔条件选择最合适的方案。请问您缺失的是上颌还是下颌？",
    "category": "修复类型"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，种植牙手术后多久可以接吻？",
    "output": "您好，关于种植牙术后接吻的问题：\n\n【术后早期（1 周内）】\n- 不建议接吻\n- 可能触碰伤口\n- 引起出血\n- 影响愈合\n\n【术后 1-2 周】\n- 伤口基本愈合\n- 可以轻柔接吻\n- 避免过度用力\n- 注意保护\n\n【术后 1 个月后】\n- 可以正常接吻\n- 种植体稳定\n- 无明显限制\n- 但仍需注意\n\n【注意事项】\n\n【力度控制】\n1. 避免过于激烈\n2. 不要碰撞手术区\n3. 轻柔为主\n4. 逐渐恢复\n\n【卫生注意】\n1. 保持口腔清洁\n2. 饭后漱口\n3. 减少细菌感染\n4. 保护伤口\n\n【特殊情况】\n- 植骨手术：建议等 2-3 周\n- 多颗种植：适当延长时间\n- 愈合不良：遵医嘱\n\n【术后恢复时间线】\n- 24 小时内：避免\n- 1 周内：强烈不建议\n- 2 周后：可以轻柔\n- 1 月后：基本正常\n\n美丽和爱情都很重要，但健康更重要。建议您等伤口愈合后再恢复亲密接触。请问您术后多久了？",
    "category": "术后护理"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，固定义齿的材料对牙龈有影响吗？",
    "output": "您好，固定义齿的材料对牙龈有一定影响：\n\n【不同材料的影响】\n\n【全瓷材料】\n- 生物相容性最好\n- 对牙龈无刺激\n- 不易引起过敏\n- 牙龈边缘美观\n- 推荐首选\n\n【贵金属烤瓷】\n- 生物相容性好\n- 对牙龈刺激小\n- 边缘密合度好\n- 不易引起过敏\n- 价格较高\n\n【钴铬合金烤瓷】\n- 生物相容性较好\n- 少数人可能过敏\n- 牙龈边缘可能发暗\n- 性价比高\n\n【镍铬合金烤瓷】\n- 生物相容性一般\n- 过敏风险较高\n- 牙龈易着色发黑\n- 已逐渐淘汰\n\n【可能的影响】\n\n【牙龈炎症】\n- 材料刺激引起\n- 边缘不密合导致\n- 需要调整或重做\n\n【牙龈着色】\n- 金属离子渗透\n- 牙龈边缘发黑\n- 影响美观\n\n【牙龈萎缩】\n- 长期刺激导致\n- 边缘暴露\n- 影响美观\n\n【选择建议】\n1. 前牙区：优先全瓷\n2. 金属过敏者：必须全瓷\n3. 后牙区：烤瓷或全瓷\n4. 经济允许：全瓷更佳\n\n建议您选择生物相容性好的材料，保护牙龈健康。请问您要做哪颗牙的修复？",
    "category": "材料选择"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，活动义齿戴上后可以喝茶吗？",
    "output": "您好，活动义齿戴上后可以喝茶，但需要注意：\n\n【可以喝茶的情况】\n\n【正常饮用】\n- 温度适宜的茶\n- 淡茶为主\n- 不影响义齿\n- 可以享受\n\n【注意事项】\n\n【温度】\n1. 不要喝太烫的茶\n2. 温热即可\n3. 避免烫伤黏膜\n4. 义齿导热差\n\n【颜色】\n1. 浓茶可能染色义齿\n2. 尤其是塑料基托\n3. 建议喝淡茶\n4. 及时漱口\n\n【时间】\n1. 饭后不要立即喝\n2. 食物残渣 + 茶 = 易着色\n3. 先清洁再喝\n4. 喝完漱口\n\n【茶的种类】\n- 绿茶：较淡，适合\n- 红茶：易着色，少喝\n- 花草茶：可以\n- 奶茶：太甜，少喝\n\n【清洁建议】\n1. 喝茶后漱口\n2. 每天清洗义齿\n3. 定期浸泡清洁\n4. 去除茶渍\n\n【不宜喝的情况】\n- 刚戴上不适应\n- 义齿明显松动\n- 口腔有溃疡\n\n建议您喝温热的淡茶，喝后及时漱口清洁。请问您平时喜欢喝什么茶？",
    "category": "术后护理"
  },
  {
    "instruction": "你是一名专业的牙科修复 AI 智能客服助手，请用专业、友好、易懂的语言回答患者关于牙科修复的问题。",
    "input": "医生，种植牙手术需要选择什么年龄做？",
    "output": "您好，种植牙手术有年龄要求：\n\n【最低年龄限制】\n\n【18 岁以上】\n- 颌骨发育基本完成\n- 可以接受种植手术\n- 女孩约 16-18 岁\n- 男孩约 18-20 岁\n\n【为什么有年龄限制】\n1. 颌骨发育未完成\n2. 种植体不会随生长移动\n3. 影响颌骨发育\n4. 导致咬合问题\n\n【最佳年龄】\n\n【青壮年期（20-50 岁）】\n- 骨质条件好\n- 愈合能力强\n- 成功率高\n- 效果最佳\n\n【中老年期（50-70 岁）】\n- 骨质开始流失\n- 愈合稍慢\n- 但成功率仍高\n- 可以种植\n\n【高龄期（70 岁以上）】\n- 评估身体状况\n- 骨质条件允许\n- 无严重疾病\n- 也可以种植\n\n【年龄不是绝对限制】\n- 关键看骨质条件\n- 全身健康状况\n- 口腔卫生习惯\n- 经济能力\n\n【不适合种植的情况】\n1. 未成年人\n2. 严重骨质疏松\n3. 未控制的糖尿病\n4. 严重心脏病\n5. 凝血功能障碍\n\n建议您到院检查，评估骨质和身体状况后决定。请问您今年多大年龄？",
    "category": "术前评估"
  }
]

# 检查新数据是否与现有数据重复
existing_inputs = set(item['input'] for item in data)
new_duplicates = [r['input'] for r in new_records if r['input'] in existing_inputs]

if new_duplicates:
    print(f"\n[警告] 新数据中有 {len(new_duplicates)} 条重复：")
    for d in new_duplicates:
        print(f"  - {d[:50]}...")
else:
    print(f"\n[OK] 新数据无重复")

# 添加新数据
data.extend(new_records)
print(f"\n添加后：{len(data)} 条")

# 保存
with open('D:/Project/毕业设计/data/train/train.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print(f"\n保存完成！")

# 统计
from collections import Counter
category_counter = Counter(item['category'] for item in data)
print("\n类别分布：")
for cat, count in sorted(category_counter.items(), key=lambda x: x[1], reverse=True):
    print(f"  {cat}: {count} 条 ({count/len(data)*100:.1f}%)")
